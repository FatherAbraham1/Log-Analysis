<?xml version="1.0" encoding="UTF-8"?>
<!-- &lt; < less than &gt; > greater than &amp; & ampersand &apos; ' apostrophe 
	&quot; " quotation mark -->
<Scheduler>
	<Action Name="Task" Begin="2015-06-11" End="2015-06-12">
	    <Period>1</Period>
	    <Step>1</Step>
		<GameId>1</GameId>
		<AccountType>1</AccountType>
		<WorldId>2</WorldId>
		<Table>TaskStart,TaskFinished</Table>
		<Sql TempTable="T1">select -1 AS `iAccountType`, 
			ConvertNull(`iWorldId`) AS `iWorldId`,
			-1 AS `iRoleJob`,
			-1 AS `iRoleGender`,
			-1 AS `iRoleLevel`,
			-1 AS `iRoleVipLevel`,
			ConvertNull(`iTaskType`) AS `iTaskType`, 
			ConvertNull(`iTaskId`) AS `iTaskId`, 
			ConvertNull(`iTaskStar`) AS `iTaskLevel`,
			COUNT(DISTINCT `iRoleId`) AS `iAcceptRoleNum`, 
			COUNT(*) AS `iAcceptTimes`,
			COUNT(DISTINCT `iUin`) AS `iAcceptUinNum` 
			FROM `TaskStart` 
			GROUP BY
			`iWorldId`,`iTaskType`,`iTaskId`,`iTaskStar` 
			WITH CUBE</Sql>
		<Sql TempTable="T2">select -1 AS `iAccountType`, 
			ConvertNull(`iWorldId`) AS `iWorldId`,
			-1 AS `iRoleJob`,
			-1 AS `iRoleGender`,
			-1 AS `iRoleLevel`,
			-1 AS `iRoleVipLevel`,
		    ConvertNull(`iTaskType`) AS `iTaskType`,
			ConvertNull(`iTaskId`) AS `iTaskId`, ConvertNull(`iTaskStar`) AS
			`iTaskLevel`, COUNT(DISTINCT `iRoleId`) AS `iCompleteRoleNum`,
			COUNT(*) AS `iCompleteTimes`, COUNT(DISTINCT `iUin`) AS
			`iCompleteUinNum`, SUM(`iTaskTime`) AS `iTotalTime` FROM TaskFinished
			GROUP BY
			`iWorldId`,`iTaskType`,`iTaskId`,`iTaskStar` 
			WITH CUBE</Sql>
		<Final
			URL="jdbc:mysql://10-4-28-24:3306/dbDJOssResult?user=oss&amp;password=oss"
			Table="oss_dm_tbTask">SELECT '2015-06-11', 
			IF(T1.iAccountType IS NULL,T2.iAccountType,T1.iAccountType), 
			IF(T1.iWorldId IS NULL,T2.iWorldId,T1.iWorldId),
            IF(T1.iRoleJob IS NULL,T2.iRoleJob,T1.iRoleJob),
            IF(T1.iRoleGender IS NULL,T2.iRoleGender,T1.iRoleGender),
            IF(T1.iRoleLevel IS NULL,T2.iRoleLevel,T1.iRoleLevel),
            IF(T1.iRoleVipLevel IS NULL,T2.iRoleVipLevel,T1.iRoleVipLevel), 			
			IF(T1.iTaskType IS NULL, T2.iTaskType, T1.iTaskType), IF(T1.iTaskId IS NULL, T2.iTaskId,
			T1.iTaskId), IF(T1.iTaskLevel IS NULL, T2.iTaskLevel, T1.iTaskLevel),
			IF(T1.iAcceptRoleNum IS NULL, '0' ,T1.iAcceptRoleNum),
			IF(T1.iAcceptTimes IS NULL, '0', T1.iAcceptTimes),
			IF(T2.iCompleteRoleNum IS NULL, '0', T2.iCompleteRoleNum),
			IF(T2.iCompleteTimes IS NULL, '0', T2.iCompleteTimes), 0, 0,
			IF(T1.iAcceptUinNum IS NULL, '0', T1.iAcceptUinNum),
			IF(T2.iCompleteUinNum IS NULL, '0', T2.iCompleteUinNum),
			IF(T2.iTotalTime IS NULL, '0', T2.iTotalTime) FROM T1 FULL JOIN T2 ON
			(T1.iAccountType=T2.iAccountType AND T1.iWorldId=T2.iWorldId AND T1.iRoleJob=T2.iRoleJob AND T1.iRoleGender=T2.iRoleGender AND T1.iRoleLevel=T2.iRoleLevel AND T1.iRoleVipLevel=T2.iRoleVipLevel AND T1.iTaskType=T2.iTaskType AND T1.iTaskId=T2.iTaskId AND
			T1.iTaskLevel=T2.iTaskLevel)</Final>
	</Action>
	<Action Name="Money" Begin="2015-06-11" End="2015-06-12">
	    <Period>1</Period>
	    <Step>1</Step>
		<GameId>1</GameId>
		<AccountType>1</AccountType>
		<WorldId>1,2</WorldId>
		<Table>MoneyFlow,RoleStatus</Table>
		<Sql TempTable="T1">select -1 AS `iAccountType`, 
			ConvertNull(`iWorldId`) AS `iWorldId`,
			-1 AS `iRoleJob`,
			-1 AS `iRoleGender`,
			-1 AS `iRoleLevel`,
			-1 AS `iRoleVipLevel`,
			ConvertNull(`iMoneyType`) AS `iMoneyType`, 
			ConvertNull(`iAction`) AS `iAction`, 
			COUNT(DISTINCT `iRoleId`) AS `iRoleNum`, 
			SUM(iMoney) AS iMoney,
			COUNT(*) AS `iTimes` 
			FROM `MoneyFlow` 
			WHERE iFlowType = 1 
			GROUP BY
			`iWorldId`,`iMoneyType`,`iAction` 
			GROUPING SETS((`iWorldId`,`iMoneyType`,`iAction`),
			(`iWorldId`,`iMoneyType`),(`iMoneyType`,`iAction`),(`iMoneyType`))</Sql>
		<Sql TempTable="T2">select -1 AS `iAccountType`, 
			ConvertNull(`iWorldId`) AS `iWorldId`,
			-1 AS `iRoleJob`,
			-1 AS `iRoleGender`,
			-1 AS `iRoleLevel`,
			-1 AS `iRoleVipLevel`,
			ConvertNull(`iMoneyType`) AS `iMoneyType`, 
			ConvertNull(`iAction`) AS `iAction`, 
			COUNT(DISTINCT `iRoleId`) AS `iRoleNum`, 
			SUM(iMoney) AS iMoney,
			COUNT(*) AS `iTimes` 
			FROM `MoneyFlow` 
			WHERE iFlowType = 2 
			GROUP BY
			`iWorldId`,`iMoneyType`,`iAction` 
			GROUPING SETS((`iWorldId`,`iMoneyType`,`iAction`),
			(`iWorldId`,`iMoneyType`),(`iMoneyType`,`iAction`),(`iMoneyType`))</Sql>
		<Sql TempTable="T3">select -1 AS `iAccountType`, 
			ConvertNull(`iWorldId`) AS `iWorldId`,
			-1 AS `iRoleJob`,
			-1 AS `iRoleGender`,
			-1 AS `iRoleLevel`,
			-1 AS `iRoleVipLevel`,
			1 AS `iMoneyType`, 
			-1 AS `iAction`, 
			COUNT(DISTINCT `iRoleId`) AS `iRoleNum`, 
			SUM(iMoney) AS iMoney 
			FROM `RoleStatus` 
			WHERE iMoney &gt; 0 
			GROUP BY
			`iWorldId` 
			WITH CUBE</Sql>
		<Sql TempTable="T4">select -1 AS `iAccountType`, 
			ConvertNull(`iWorldId`) AS `iWorldId`,
			-1 AS `iRoleJob`,
			-1 AS `iRoleGender`,
			-1 AS `iRoleLevel`,
			-1 AS `iRoleVipLevel`,
			2 AS `iMoneyType`, 
			-1 AS `iAction`, 
			COUNT(DISTINCT `iRoleId`) AS `iRoleNum`, 
			SUM(iPoints) AS iMoney 
			FROM `RoleStatus` 
			WHERE iPoints &gt; 0 
			GROUP BY
			`iWorldId` 
			WITH CUBE</Sql>
		<Final
			URL="jdbc:mysql://10-4-28-24:3306/dbDJOssResult?user=oss&amp;password=oss"
			Table="oss_dm_tbMoneyProduce">SELECT '2015-06-11', 
			iAccountType, 
			iWorldId,
            iRoleJob,
            iRoleGender,
            iRoleLevel,
            iRoleVipLevel, 			
			iMoneyType, 
			iAction, 
			iRoleNum,
			iMoney,
			iTimes 
			FROM T1 </Final>
		<Final
			URL="jdbc:mysql://10-4-28-24:3306/dbDJOssResult?user=oss&amp;password=oss"
			Table="oss_dm_tbMoneyConsume">SELECT '2015-06-11', 
			iAccountType, 
			iWorldId,
            iRoleJob,
            iRoleGender,
            iRoleLevel,
            iRoleVipLevel, 			
			iMoneyType, 
			iAction, 
			iRoleNum,
			iMoney,
			iTimes 
			FROM T2 </Final>
		<Final
			URL="jdbc:mysql://10-4-28-24:3306/dbDJOssResult?user=oss&amp;password=oss"
			Table="oss_dm_tbMoneyStorage">SELECT '2015-06-11', 
			iAccountType, 
			iWorldId,
            iRoleJob,
            iRoleGender,
            iRoleLevel,
            iRoleVipLevel, 			
			iMoneyType, 
			iAction, 
			iRoleNum,
			iMoney 
			FROM T3 </Final>
		<Final
			URL="jdbc:mysql://10-4-28-24:3306/dbDJOssResult?user=oss&amp;password=oss"
			Table="oss_dm_tbMoneyStorage">SELECT '2015-06-11', 
			iAccountType, 
			iWorldId,
            iRoleJob,
            iRoleGender,
            iRoleLevel,
            iRoleVipLevel, 			
			iMoneyType, 
			iAction, 
			iRoleNum,
			iMoney 
			FROM T4 </Final>
	</Action>	
		<Action Name="RoleJobLvDis" Begin="2015-06-11" End="2015-06-12">
	    <Period>1</Period>
	    <Step>1</Step>
		<GameId>1</GameId>
		<AccountType>1</AccountType>
		<WorldId>1,2</WorldId>
		<Table>RoleStatus</Table>
		<Sql TempTable="T1">select -1 AS `iAccountType`, 
			ConvertNull(`iWorldId`) AS `iWorldId`,
			ConvertNull(`iRoleJob`) AS `iRoleJob`,
			ConvertNull(`iRoleGender`) AS `iRoleGender`,
			ConvertNull(`iRoleLevel`) AS `iRoleLevel`,
			ConvertNull(`iRoleVipLevel`) AS `iRoleVipLevel`,
			COUNT(DISTINCT `iRoleId`) AS `iRoleNum` 
			FROM `RoleStatus` 
			GROUP BY
			`iWorldId`,`iRoleJob`,`iRoleGender`, `iRoleLevel`,`iRoleVipLevel` 
			WITH CUBE</Sql>
		<Sql TempTable="T2">select -1 AS `iAccountType`, 
			ConvertNull(`iWorldId`) AS `iWorldId`,
			ConvertNull(`iRoleJob`) AS `iRoleJob`,
			ConvertNull(`iRoleGender`) AS `iRoleGender`,
			ConvertNull(`iRoleLevel`) AS `iRoleLevel`,
			ConvertNull(`iRoleVipLevel`) AS `iRoleVipLevel`,
			COUNT(DISTINCT `iRoleId`) AS `iRoleNum` 
			FROM `RoleStatus` 
			WHERE `dtRoleLastSaveTime` &gt;= '2015-06-11' AND `dtRoleLastSaveTime` &lt; '2015-06-12' 
			GROUP BY
			`iWorldId`,`iRoleJob`,`iRoleGender`, `iRoleLevel`,`iRoleVipLevel` 
			WITH CUBE</Sql>
		<Final
			URL="jdbc:mysql://10-4-28-24:3306/dbDJOssResult?user=oss&amp;password=oss"
			Table="oss_dm_tbRoleJobLvDis">SELECT '2015-06-11', 
			iAccountType, 
			iWorldId,
            iRoleJob,
            iRoleGender,
            iRoleLevel,
            iRoleVipLevel, 			 
			iRoleNum 
			FROM T1 </Final>
		<Final
			URL="jdbc:mysql://10-4-28-24:3306/dbDJOssResult?user=oss&amp;password=oss"
			Table="oss_dm_tbDayActiRoleJobLvDis">SELECT '2015-06-11', 
			iAccountType, 
			iWorldId,
            iRoleJob,
            iRoleGender,
            iRoleLevel,
            iRoleVipLevel, 			
			iRoleNum 
			FROM T2 </Final>
	</Action>	
</Scheduler>    